# DWI_Tractography
### This project contains an analysis pipeline that takes raw DWI MRI data as input, performs preprocessing, then performs probabilistic streamline tractography. Among the many intermediate files, the resulting output contains a whole-brain "tractogram", or structural connectome, in subject's native DWI space. 

### The following is an example methods section that describes this pipeline, including associated references:
The DWI data were processed using tools from FSL (v6.0) and MRtrix3 (Smith et al., 2004; Tournier et al., 2019). First, the raw diffusion data was first converted from DICOM to MIF format using MRtrix3’s mrconvert function. Next, the DWIs were denoised using dwidenoise, which has been shown to improve the subsequent estimation of diffusion parameters and fiber orientation distributions (Cordero-Grande et al., 2019; Veraart et al., 2016). FSL’s TOPUP program was used to correct for distortions in the acquired diffusion-weighted images (which is critical for anatomically accurate tractography) (Andersson et al., 2003). MRtrix3’s dwifslpreproc program was used to implement both TOPUP and FSL’s eddy tool, which corrects for motion and eddy current artifacts including outlier replacement (Andersson et al., 2016; Andersson and Sotiropoulos, 2016). The T1-w anatomical image was affine registered to the distortion-corrected b0 image using FSL’s flirt program. With this transformation, the FreeSurfer-derived tissue masks were sampled to a subject’s native DWI-space for use within the tractography pipeline. While the primary analyses were carried out in native DWI-space followed by sampling to subjects’ standardized cortical surfaces, we further assessed the volumetric overlap of our tracts of interests with canonical white matter bundles. For this analysis, a nonlinear registration of the T1-w anatomical images to the MNI152-2009 template was achieved using AFNI’s auto_warp.py script, and the transformation subsequently applied to the DWI-space streamline density images (see below).

Streamline tractography was carried out using MRtrix3 (Tournier et al., 2019). From the preprocessed DWI volumes, we first implemented an unsupervised method for estimating single-fiber response functions for white matter (WM), gray matter (GM), and cerebrospinal fluid (CSF), via dwi2response with the “dhollander” algorithm (Dhollander et al., 2019). To facilitate later group-level comparisons, the group average response function for each tissue type was used for subsequent estimation of fiber orientation distributions (FODs) (Smith et al., 2020). Multi-shell multi-tissue constrained spherical deconvolution (MSMT-CSD) was performed to obtain WM-like FODs as well as GM-like and CSF-like compartments in all voxels (Jeurissen et al., 2014), a framework which more faithfully resolves FODs in areas of partial voluming between tissues and ultimately improves tractography. Prior to streamline generation, the FOD maps were corrected for bias fields and intensity inhomogeneities via mtnormalise (Raffelt et al., 2017). Probabilistic tracking was then performed to construct a whole-brain structural connectome (i.e., “tractogram”) via tckgen with the “iFOD2” algorithm (Tournier and , F. Calamante, 2010). The tractogram was created by generating 10 million streamlines which were randomly seeded and terminated (including “back-tracking”) at the GM/WM interface (GMWMI) as delineated by FreeSurfer. This method, called Anatomically-Constrained Tractography (ACT), improves the biological accuracy of the reconstructed streamlines by ensuring that, like the underlying axons, all streamlines begin and end (i.e., “synapse”) at some GM structure (Smith et al., 2012). Following tractogram construction, we used the successor to the “spherical-deconvolution informed filtering of tractograms” method (SIFT2, via tcksift2) to assign a weight (i.e., a cross-sectional area multiplier) to each streamline (Smith et al., 2015a, 2013). This process corrects for biases in tractography associated with the fact that streamlines are volume-less entities, which, for instance, can result in overrepresentation of certain tracts. Specifically, SIFT2 ensures that the (weighted) streamline reconstruction is an adequate fit of the diffusion signal (i.e., the CSD model) at each voxel, which is itself proportional to the volume of tissue aligned in each orientation. This effectively guarantees that the summed weight of streamlines connecting any two brain regions is proportional to the total cross-sectional area of WM fibers connecting these regions, providing a physically interpretable, quantitative measure of structural connectivity (Smith et al., 2020). Overall, the tractography pipeline implemented here capitalizes on recent advancements in the field and has been shown to: 1) significantly improve the biological validity of structural connectivity metrics derived from streamlines (Smith et al., 2015b), 2) reduce inter-subject variability introduced by fiber-tracking biases (Yeh et al., 2016), and 3) improve the reproducibility of tractography results compared to other pipelines (Nath et al., 2019).

REFERENCES:

Andersson, J. L. R., Graham, M. S., Zsoldos, E., & Sotiropoulos, S. N. (2016). Incorporating outlier detection and replacement into a non-parametric framework for movement and distortion correction of diffusion MR images. NeuroImage, 141, 556–572. https://doi.org/10.1016/j.neuroimage.2016.06.058

Andersson, J. L. R., Skare, S., & Ashburner, J. (2003). How to correct susceptibility distortions in spin-echo echo-planar images: Application to diffusion tensor imaging. NeuroImage, 20(2), 870–888. https://doi.org/10.1016/S1053-8119(03)00336-7

Andersson, J. L. R., & Sotiropoulos, S. N. (2016). An integrated approach to correction for off-resonance effects and subject movement in diffusion MR imaging. NeuroImage, 125, 1063–1078. https://doi.org/10.1016/j.neuroimage.2015.10.019

Cordero-Grande, L., Christiaens, D., Hutter, J., Price, A. N., & Hajnal, J. V. (2019). Complex diffusion-weighted image estimation via matrix recovery under general noise models. NeuroImage, 200(March), 391–404. https://doi.org/10.1016/j.neuroimage.2019.06.039

Dhollander, T., Mito, R., Raffelt, D., & Connelly, A. (2019). Improved white matter response function estimation for 3-tissue constrained spherical deconvolution. Proc. Intl. Soc. Mag. Reson. Med, (May 11-16), 555.

Jeurissen, B., Tournier, J. D., Dhollander, T., Connelly, A., & Sijbers, J. (2014). Multi-tissue constrained spherical deconvolution for improved analysis of multi-shell diffusion MRI data. NeuroImage, 103, 411–426. https://doi.org/10.1016/j.neuroimage.2014.07.061

Nath, V., Schilling, K. G., Parvathaneni, P., Huo, Y., Blaber, J. A., Hainline, A. E., … Landman, B. A. (2019). Tractography reproducibility challenge with empirical data (TraCED): The 2017 ISMRM diffusion study group challenge. Journal of Magnetic Resonance Imaging, 1–16. https://doi.org/10.1002/jmri.26794

Raffelt, D., Dhollander, T., Tournier, J. D., Tabbara, R., Smith, R. E., Pierre, E., & Connelly, A. (2017). Bias field correction and intensity normalisation for quantitative analysis of apparent fiber density. Proc Intl Soc Mag Reson Med, 25(April), 3541. Retrieved from https://www.researchgate.net/publication/315836355

Smith, R. E., Raffelt, D., Tournier, J., & Connelly, A. (2020). Quantitative streamlines tractography : methods and inter-subject normalisation, (c), 1–27.

Smith, R. E., Tournier, J.-D., Calamante, F., & Connelly, A. (2012). Anatomically-constrained tractography: Improved diffusion MRI streamlines tractography through effective use of anatomical information. NeuroImage, 62(3), 1924–1938. https://doi.org/10.1016/j.neuroimage.2012.06.005

Smith, R. E., Tournier, J. D., Calamante, F., & Connelly, A. (2013). SIFT: Spherical-deconvolution informed filtering of tractograms. NeuroImage, 67, 298–312. https://doi.org/10.1016/j.neuroimage.2012.11.049

Smith, R. E., Tournier, J. D., Calamante, F., & Connelly, A. (2015a). SIFT2: Enabling dense quantitative assessment of brain white matter connectivity using streamlines tractography. NeuroImage, 119, 338–351. https://doi.org/10.1016/j.neuroimage.2015.06.092

Smith, R. E., Tournier, J. D., Calamante, F., & Connelly, A. (2015b). The effects of SIFT on the reproducibility and biological accuracy of the structural connectome. NeuroImage, 104, 253–265. https://doi.org/10.1016/j.neuroimage.2014.10.004

Smith, S. M., Jenkinson, M., Woolrich, M. W., Beckmann, C. F., Behrens, T. E. J., Johansen-Berg, H., … Matthews, P. M. (2004). Advances in functional and structural MR image analysis and implementation as FSL. NeuroImage, 23(SUPPL. 1), S208–S219. https://doi.org/10.1016/j.neuroimage.2004.07.051

Tournier, J-D., Calamante, F., & Connelly, A. (2010). Improved probabilistic streamlines tractography by 2 nd order integration over fibre orientation distributions. ISMRM, 88(2003), 2010.

Tournier, J-Donald, Smith, R., Raffelt, D., Tabbara, R., Dhollander, T., Pietsch, M., … Connelly, A. (2019). MRtrix3: A fast, flexible and open software framework for medical image processing and visualisation. NeuroImage, 202(January), 116137. https://doi.org/10.1016/j.neuroimage.2019.116137

Veraart, J., Novikov, D. S., Christiaens, D., Ades-aron, B., Sijbers, J., & Fieremans, E. (2016). Denoising of diffusion MRI using random matrix theory. NeuroImage, 142, 394–406. https://doi.org/10.1016/j.neuroimage.2016.08.016

Yeh, C. H., Smith, R. E., Liang, X., Calamante, F., & Connelly, A. (2016). Correction for diffusion MRI fibre tracking biases: The consequences for structural connectomic metrics. NeuroImage, 142, 150–162. https://doi.org/10.1016/j.neuroimage.2016.05.047

